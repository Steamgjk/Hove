i= 0   torch.Size([64, 3, 3, 3])   tensor(1728)
i= 1   torch.Size([64])   tensor(64)
i= 2   torch.Size([64])   tensor(64)
i= 3   torch.Size([64])   tensor(64)
i= 4   torch.Size([64, 64, 3, 3])   tensor(36864)
i= 5   torch.Size([64])   tensor(64)
i= 6   torch.Size([64])   tensor(64)
i= 7   torch.Size([64])   tensor(64)
i= 8   torch.Size([128, 64, 3, 3])   tensor(73728)
i= 9   torch.Size([128])   tensor(128)
i= 10   torch.Size([128])   tensor(128)
i= 11   torch.Size([128])   tensor(128)
i= 12   torch.Size([128, 128, 3, 3])   tensor(147456)
i= 13   torch.Size([128])   tensor(128)
i= 14   torch.Size([128])   tensor(128)
i= 15   torch.Size([128])   tensor(128)
i= 16   torch.Size([256, 128, 3, 3])   tensor(294912)
i= 17   torch.Size([256])   tensor(256)
i= 18   torch.Size([256])   tensor(256)
i= 19   torch.Size([256])   tensor(256)
i= 20   torch.Size([256, 256, 3, 3])   tensor(589824)
i= 21   torch.Size([256])   tensor(256)
i= 22   torch.Size([256])   tensor(256)
i= 23   torch.Size([256])   tensor(256)
i= 24   torch.Size([256, 256, 3, 3])   tensor(589824)
i= 25   torch.Size([256])   tensor(256)
i= 26   torch.Size([256])   tensor(256)
i= 27   torch.Size([256])   tensor(256)
i= 28   torch.Size([256, 256, 3, 3])   tensor(589824)
i= 29   torch.Size([256])   tensor(256)
i= 30   torch.Size([256])   tensor(256)
i= 31   torch.Size([256])   tensor(256)
i= 32   torch.Size([512, 256, 3, 3])   tensor(1179648)
i= 33   torch.Size([512])   tensor(512)
i= 34   torch.Size([512])   tensor(512)
i= 35   torch.Size([512])   tensor(512)
i= 36   torch.Size([512, 512, 3, 3])   tensor(2359296)
i= 37   torch.Size([512])   tensor(512)
i= 38   torch.Size([512])   tensor(512)
i= 39   torch.Size([512])   tensor(512)
i= 40   torch.Size([512, 512, 3, 3])   tensor(2359296)
i= 41   torch.Size([512])   tensor(512)
i= 42   torch.Size([512])   tensor(512)
i= 43   torch.Size([512])   tensor(512)
i= 44   torch.Size([512, 512, 3, 3])   tensor(2359296)
i= 45   torch.Size([512])   tensor(512)
i= 46   torch.Size([512])   tensor(512)
i= 47   torch.Size([512])   tensor(512)
i= 48   torch.Size([512, 512, 3, 3])   tensor(2359296)
i= 49   torch.Size([512])   tensor(512)
i= 50   torch.Size([512])   tensor(512)
i= 51   torch.Size([512])   tensor(512)
i= 52   torch.Size([512, 512, 3, 3])   tensor(2359296)
i= 53   torch.Size([512])   tensor(512)
i= 54   torch.Size([512])   tensor(512)
i= 55   torch.Size([512])   tensor(512)
i= 56   torch.Size([512, 512, 3, 3])   tensor(2359296)
i= 57   torch.Size([512])   tensor(512)
i= 58   torch.Size([512])   tensor(512)
i= 59   torch.Size([512])   tensor(512)
i= 60   torch.Size([512, 512, 3, 3])   tensor(2359296)
i= 61   torch.Size([512])   tensor(512)
i= 62   torch.Size([512])   tensor(512)
i= 63   torch.Size([512])   tensor(512)
i= 64   torch.Size([4096, 25088])   tensor(102760448)
i= 65   torch.Size([4096])   tensor(4096)
i= 66   torch.Size([4096, 4096])   tensor(16777216)
i= 67   torch.Size([4096])   tensor(4096)
i= 68   torch.Size([4096, 4096])   tensor(16777216)
i= 69   torch.Size([4096])   tensor(4096)
i= 70   torch.Size([1000, 4096])   tensor(4096000)
i= 71   torch.Size([1000])   tensor(1000)




out layer sz
i= 0   {'shape': torch.Size([1, 3, 224, 224]), 'size': tensor(150528), 'type': <class 'vgg.HookLayer'>}
i= 1   {'shape': torch.Size([1, 64, 224, 224]), 'size': tensor(3211264), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 2   {'shape': torch.Size([1, 64, 224, 224]), 'size': tensor(3211264), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 3   {'shape': torch.Size([1, 64, 224, 224]), 'size': tensor(3211264), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 4   {'shape': torch.Size([1, 64, 224, 224]), 'size': tensor(3211264), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 5   {'shape': torch.Size([1, 64, 224, 224]), 'size': tensor(3211264), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 6   {'shape': torch.Size([1, 64, 224, 224]), 'size': tensor(3211264), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 7   {'shape': torch.Size([1, 64, 112, 112]), 'size': tensor(802816), 'type': <class 'torch.nn.modules.pooling.MaxPool2d'>}
i= 8   {'shape': torch.Size([1, 128, 112, 112]), 'size': tensor(1605632), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 9   {'shape': torch.Size([1, 128, 112, 112]), 'size': tensor(1605632), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 10   {'shape': torch.Size([1, 128, 112, 112]), 'size': tensor(1605632), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 11   {'shape': torch.Size([1, 128, 112, 112]), 'size': tensor(1605632), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 12   {'shape': torch.Size([1, 128, 112, 112]), 'size': tensor(1605632), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 13   {'shape': torch.Size([1, 128, 112, 112]), 'size': tensor(1605632), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 14   {'shape': torch.Size([1, 128, 56, 56]), 'size': tensor(401408), 'type': <class 'torch.nn.modules.pooling.MaxPool2d'>}
i= 15   {'shape': torch.Size([1, 256, 56, 56]), 'size': tensor(802816), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 16   {'shape': torch.Size([1, 256, 56, 56]), 'size': tensor(802816), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 17   {'shape': torch.Size([1, 256, 56, 56]), 'size': tensor(802816), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 18   {'shape': torch.Size([1, 256, 56, 56]), 'size': tensor(802816), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 19   {'shape': torch.Size([1, 256, 56, 56]), 'size': tensor(802816), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 20   {'shape': torch.Size([1, 256, 56, 56]), 'size': tensor(802816), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 21   {'shape': torch.Size([1, 256, 56, 56]), 'size': tensor(802816), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 22   {'shape': torch.Size([1, 256, 56, 56]), 'size': tensor(802816), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 23   {'shape': torch.Size([1, 256, 56, 56]), 'size': tensor(802816), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 24   {'shape': torch.Size([1, 256, 56, 56]), 'size': tensor(802816), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 25   {'shape': torch.Size([1, 256, 56, 56]), 'size': tensor(802816), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 26   {'shape': torch.Size([1, 256, 56, 56]), 'size': tensor(802816), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 27   {'shape': torch.Size([1, 256, 28, 28]), 'size': tensor(200704), 'type': <class 'torch.nn.modules.pooling.MaxPool2d'>}
i= 28   {'shape': torch.Size([1, 512, 28, 28]), 'size': tensor(401408), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 29   {'shape': torch.Size([1, 512, 28, 28]), 'size': tensor(401408), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 30   {'shape': torch.Size([1, 512, 28, 28]), 'size': tensor(401408), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 31   {'shape': torch.Size([1, 512, 28, 28]), 'size': tensor(401408), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 32   {'shape': torch.Size([1, 512, 28, 28]), 'size': tensor(401408), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 33   {'shape': torch.Size([1, 512, 28, 28]), 'size': tensor(401408), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 34   {'shape': torch.Size([1, 512, 28, 28]), 'size': tensor(401408), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 35   {'shape': torch.Size([1, 512, 28, 28]), 'size': tensor(401408), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 36   {'shape': torch.Size([1, 512, 28, 28]), 'size': tensor(401408), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 37   {'shape': torch.Size([1, 512, 28, 28]), 'size': tensor(401408), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 38   {'shape': torch.Size([1, 512, 28, 28]), 'size': tensor(401408), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 39   {'shape': torch.Size([1, 512, 28, 28]), 'size': tensor(401408), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 40   {'shape': torch.Size([1, 512, 14, 14]), 'size': tensor(100352), 'type': <class 'torch.nn.modules.pooling.MaxPool2d'>}
i= 41   {'shape': torch.Size([1, 512, 14, 14]), 'size': tensor(100352), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 42   {'shape': torch.Size([1, 512, 14, 14]), 'size': tensor(100352), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 43   {'shape': torch.Size([1, 512, 14, 14]), 'size': tensor(100352), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 44   {'shape': torch.Size([1, 512, 14, 14]), 'size': tensor(100352), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 45   {'shape': torch.Size([1, 512, 14, 14]), 'size': tensor(100352), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 46   {'shape': torch.Size([1, 512, 14, 14]), 'size': tensor(100352), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 47   {'shape': torch.Size([1, 512, 14, 14]), 'size': tensor(100352), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 48   {'shape': torch.Size([1, 512, 14, 14]), 'size': tensor(100352), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 49   {'shape': torch.Size([1, 512, 14, 14]), 'size': tensor(100352), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 50   {'shape': torch.Size([1, 512, 14, 14]), 'size': tensor(100352), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 51   {'shape': torch.Size([1, 512, 14, 14]), 'size': tensor(100352), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 52   {'shape': torch.Size([1, 512, 14, 14]), 'size': tensor(100352), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 53   {'shape': torch.Size([1, 512, 7, 7]), 'size': tensor(25088), 'type': <class 'torch.nn.modules.pooling.MaxPool2d'>}
i= 54   {'shape': torch.Size([1, 512, 7, 7]), 'size': tensor(25088), 'type': <class 'torch.nn.modules.pooling.AvgPool2d'>}
i= 55   {'shape': torch.Size([1, 4096]), 'size': tensor(4096), 'type': <class 'torch.nn.modules.linear.Linear'>}
i= 56   {'shape': torch.Size([1, 4096]), 'size': tensor(4096), 'type': <class 'torch.nn.modules.linear.Linear'>}
i= 57   {'shape': torch.Size([1, 4096]), 'size': tensor(4096), 'type': <class 'torch.nn.modules.linear.Linear'>}
i= 58   {'shape': torch.Size([1, 1000]), 'size': tensor(1000), 'type': <class 'torch.nn.modules.linear.Linear'>}


i= 0   {'shape': torch.Size([4, 3, 224, 224]), 'size': tensor(602112), 'type': <class 'vgg.HookLayer'>}
i= 1   {'shape': torch.Size([4, 64, 224, 224]), 'size': tensor(12845056), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 2   {'shape': torch.Size([4, 64, 224, 224]), 'size': tensor(12845056), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 3   {'shape': torch.Size([4, 64, 224, 224]), 'size': tensor(12845056), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 4   {'shape': torch.Size([4, 64, 224, 224]), 'size': tensor(12845056), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 5   {'shape': torch.Size([4, 64, 224, 224]), 'size': tensor(12845056), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 6   {'shape': torch.Size([4, 64, 224, 224]), 'size': tensor(12845056), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 7   {'shape': torch.Size([4, 64, 112, 112]), 'size': tensor(3211264), 'type': <class 'torch.nn.modules.pooling.MaxPool2d'>}
i= 8   {'shape': torch.Size([4, 128, 112, 112]), 'size': tensor(6422528), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 9   {'shape': torch.Size([4, 128, 112, 112]), 'size': tensor(6422528), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 10   {'shape': torch.Size([4, 128, 112, 112]), 'size': tensor(6422528), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 11   {'shape': torch.Size([4, 128, 112, 112]), 'size': tensor(6422528), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 12   {'shape': torch.Size([4, 128, 112, 112]), 'size': tensor(6422528), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 13   {'shape': torch.Size([4, 128, 112, 112]), 'size': tensor(6422528), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 14   {'shape': torch.Size([4, 128, 56, 56]), 'size': tensor(1605632), 'type': <class 'torch.nn.modules.pooling.MaxPool2d'>}
i= 15   {'shape': torch.Size([4, 256, 56, 56]), 'size': tensor(3211264), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 16   {'shape': torch.Size([4, 256, 56, 56]), 'size': tensor(3211264), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 17   {'shape': torch.Size([4, 256, 56, 56]), 'size': tensor(3211264), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 18   {'shape': torch.Size([4, 256, 56, 56]), 'size': tensor(3211264), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 19   {'shape': torch.Size([4, 256, 56, 56]), 'size': tensor(3211264), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 20   {'shape': torch.Size([4, 256, 56, 56]), 'size': tensor(3211264), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 21   {'shape': torch.Size([4, 256, 56, 56]), 'size': tensor(3211264), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 22   {'shape': torch.Size([4, 256, 56, 56]), 'size': tensor(3211264), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 23   {'shape': torch.Size([4, 256, 56, 56]), 'size': tensor(3211264), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 24   {'shape': torch.Size([4, 256, 56, 56]), 'size': tensor(3211264), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 25   {'shape': torch.Size([4, 256, 56, 56]), 'size': tensor(3211264), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 26   {'shape': torch.Size([4, 256, 56, 56]), 'size': tensor(3211264), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 27   {'shape': torch.Size([4, 256, 28, 28]), 'size': tensor(802816), 'type': <class 'torch.nn.modules.pooling.MaxPool2d'>}
i= 28   {'shape': torch.Size([4, 512, 28, 28]), 'size': tensor(1605632), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 29   {'shape': torch.Size([4, 512, 28, 28]), 'size': tensor(1605632), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 30   {'shape': torch.Size([4, 512, 28, 28]), 'size': tensor(1605632), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 31   {'shape': torch.Size([4, 512, 28, 28]), 'size': tensor(1605632), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 32   {'shape': torch.Size([4, 512, 28, 28]), 'size': tensor(1605632), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 33   {'shape': torch.Size([4, 512, 28, 28]), 'size': tensor(1605632), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 34   {'shape': torch.Size([4, 512, 28, 28]), 'size': tensor(1605632), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 35   {'shape': torch.Size([4, 512, 28, 28]), 'size': tensor(1605632), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 36   {'shape': torch.Size([4, 512, 28, 28]), 'size': tensor(1605632), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 37   {'shape': torch.Size([4, 512, 28, 28]), 'size': tensor(1605632), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 38   {'shape': torch.Size([4, 512, 28, 28]), 'size': tensor(1605632), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 39   {'shape': torch.Size([4, 512, 28, 28]), 'size': tensor(1605632), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 40   {'shape': torch.Size([4, 512, 14, 14]), 'size': tensor(401408), 'type': <class 'torch.nn.modules.pooling.MaxPool2d'>}
i= 41   {'shape': torch.Size([4, 512, 14, 14]), 'size': tensor(401408), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 42   {'shape': torch.Size([4, 512, 14, 14]), 'size': tensor(401408), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 43   {'shape': torch.Size([4, 512, 14, 14]), 'size': tensor(401408), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 44   {'shape': torch.Size([4, 512, 14, 14]), 'size': tensor(401408), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 45   {'shape': torch.Size([4, 512, 14, 14]), 'size': tensor(401408), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 46   {'shape': torch.Size([4, 512, 14, 14]), 'size': tensor(401408), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 47   {'shape': torch.Size([4, 512, 14, 14]), 'size': tensor(401408), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 48   {'shape': torch.Size([4, 512, 14, 14]), 'size': tensor(401408), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 49   {'shape': torch.Size([4, 512, 14, 14]), 'size': tensor(401408), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 50   {'shape': torch.Size([4, 512, 14, 14]), 'size': tensor(401408), 'type': <class 'torch.nn.modules.conv.Conv2d'>}
i= 51   {'shape': torch.Size([4, 512, 14, 14]), 'size': tensor(401408), 'type': <class 'torch.nn.modules.batchnorm.BatchNorm2d'>}
i= 52   {'shape': torch.Size([4, 512, 14, 14]), 'size': tensor(401408), 'type': <class 'torch.nn.modules.activation.ReLU'>}
i= 53   {'shape': torch.Size([4, 512, 7, 7]), 'size': tensor(100352), 'type': <class 'torch.nn.modules.pooling.MaxPool2d'>}
i= 54   {'shape': torch.Size([4, 512, 7, 7]), 'size': tensor(100352), 'type': <class 'torch.nn.modules.pooling.AvgPool2d'>}
i= 55   {'shape': torch.Size([4, 4096]), 'size': tensor(16384), 'type': <class 'torch.nn.modules.linear.Linear'>}
i= 56   {'shape': torch.Size([4, 4096]), 'size': tensor(16384), 'type': <class 'torch.nn.modules.linear.Linear'>}
i= 57   {'shape': torch.Size([4, 4096]), 'size': tensor(16384), 'type': <class 'torch.nn.modules.linear.Linear'>}
i= 58   {'shape': torch.Size([4, 1000]), 'size': tensor(4000), 'type': <class 'torch.nn.modules.linear.Linear'>}
